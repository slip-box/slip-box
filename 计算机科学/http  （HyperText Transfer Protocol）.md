## http  （HyperText Transfer Protocol）
超文本传输协议，其实准确的称呼为超文本转移协议，
目前主流的[[HTTP]]协议版本为HTTP/1.1
修订与1997年1月，当前虚心修订版为RFC2616。

属于TCP/IP协议族的子集

## TCP/IP
TCP/IP协议族最重要的特点就是分层：
- 应用层
- 传输层
- 网络层
- 数据链路层

分层的好处：如果网络中某些地方需要改动设计，那么只需改某一层即可，避免全部改动。

### 应用层
决定向用户提供通讯活动类型，如文件传输FTP，DNS以及HTTP协议，也处于该层。
### 传输层
服务于上层（应用层）的数据传输，分割数据，形成包，并打标机及端口号，此层有TCP，UDP（数据报协议）
### 网络层
处理网络上流动的数据包，数据包是传输最小数据单位，此层决定传输路线。
### 数据链路层
处理链接网络的硬件部分，光驱，网卡，等物理设备。

## TCP/IP通信流过程
- 发送端：从应用层往下走，直到链路层，与接受方服务器链接
- 接收端：从链路层往上走，直到应用层

**过程如下：** 客户端在应用层发起一个请求查看某页面的HTPP（应用层）请求，为了传输方便，传输层用（TCP）协议把从应用层收到的数据（HTTP请求报文）分割，并在分割后的各个报文上**打标记序号及端口号**后，转发给下一层——网络层。

在网络层（IP协议），添加作为通信目的地的MAC地址后再转发给链路层。（网路程负责传输最合适的路由）

接收端服务器的链路层上接收数据，去掉消息头信息，按序往上层（网络层）发送，直到应用层，才算接收到请求数据。

发送端每一层都对报文添加该层的头信息（封装数据），接收方网上曾转发的每一层都去掉对应的头信息。 总之就是封装与解封。
## 使用ARP协议凭借MAC地址进行通信
ip间的通信以来MAC地址，中转时，利用下一站中转设备的MAC地址来搜索下一个中转目标。
### 1.4.2 确保可靠性的TCP协议
TCP位于传输层（分割数据），提供可靠地字节流服务。TCP分割数据且能确保数据是否到达，通过**三次握手**

**三次握手：**发送端先发一个带SYN标志的数据包，接收方收到后返回一个带有SYN/ACK标示的数据包标示确认。最后发送方再传回一个带ACK标志的数据包，代表握手结束。 若中间有某次中断，则以相同顺序再发送数据包。（除了三次握手外TCP还有其他方式保证可靠性）

## 1.5 DNS解析
DNS（Domain Name System）域名解析是和HTTP协议一样服务于应用层。

过程：发送端先访问DNS服务请求页面域名，DNS把对应的IP发给客户端，客户算再请求得到的IP地址服务器

## 输入网址后，浏览器过程如下：
先看DNS缓存，没有像DNS查询ip地址，后访问该IP地址：应用层发出HTTP请求报文，传输层（TCP协议）分割数据并添加头信息，网络层搜索对方地址，寻找合适路由，（乡下传输到链路层），对方接受到数据包后按顺序拼接报文，到达对方应用层做出HTTP响应。下载文件，浏览器解析，形成DOM树，重绘，重排。。。。
## URL和URI
统一资源定位符和统一资源标示符，前者是后者的子集，URL < URI. URI表示某一网络资源，开头各种协议FTP，HTTP等，URL专指网络地址。

# 第二章 简单的HTTP协议 （HTTP1.1）
## 无状态，不保存状态的协议
每次会话都是新的，优势：设计简单可快速处理大量事物，确保协议伸缩性，记住请求方状态服务器CPU会很有压力。劣势：不能标记用户的登录状态。

解决办法：
- 使用Cookie技术
- 持久连接keep-alive （HTTP1.1协议）
### Cookie技术：在请求和相应报文中添加cookie信息控制客户端状态
服务器响应一个带有Set-Cookie的首部信息，通知客户端保存cookie，客户端请求时自动把cookie加入请求信息中。服务器收到cookie后与服务器上的记录做对比，得出状态。

### 持久链接
**持久连接：**只要任意一端没有明确提出断开连接，则默认保持TCP连接状态。
**好处：**减少频繁无效的断开、连接造成的损耗，传输更快速
### 长连接使请求管线化
持久连接使得请求**管线化：**可以不等待相应而继续发送下一请求，同时并发多个请求。

# 第三章

http报文（8bit字节流）就是由多行由CR+CF换行的字符串文本，无论是请求报文，还是响应报文都包含：

- 报文首部
- 空行（CR+CF）
- 报文主体（不一定都有）

请求报文首部包含：host，user-agent，accept，accept-encoding，cache等

响应报文包含：date，server，last-modified，content-type等信息。

### 为了传输更快，对报文实体进行：编码压缩、分块传输

#### 压缩内容，进行编码

对报文实体内容编码（例如：gzip）可加快传输速度，但会消耗cpu，服务器编码，客户端解码

#### 分快传输编码

浏览器在实体资源未传输玩之前不会显示，分块传输可使浏览器逐步显示。