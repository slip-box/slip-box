既然叫二维码，那肯定有一维码，没错，一维码就是最常见的条形码；

为什么有了条形码还要有二维码？
条形码先天不足：承载的信息少，坑损坏风险低，这些正是二维码的优点；

## 二维码
在上世纪80年代就诞生了且多种多样，最终来自日本电装公司，诞生于1994年的二维码制胜出，成为现在的二维码；早期用于汽车零部件，用于后续的追踪，没有专利、开放式授权，被广泛用于世界各地；

## 二维码如何扫码登录
首先二维码是个url链接，既然是链接就可以携带参数。那么扫码登录相当于手机访问某个带参链接；

登录的本质是什么？获得授信的token而已：
- 告诉系统我是谁
- 证明系统我是谁

那么现在已经具备的条件有：
- 手机已经登录后的可信token
- 服务端有此token对应的用户身份信息
- PC另一端一个带参的url【二维码】

想要PC端扫码登录，无非通过已授信的token，声明自己，并验证自己：
- 手机扫码可以告诉系统我是谁
- 手机端的可信token和服务端信息验证后，可以证明我是谁

下面就是具体交换过程了，本质上已经不再是重点，具体交换逻辑可根据安全等级有细微差异，可繁可简：
二维码有三个状态：
- 待扫码
- 已扫码，待确认
- 已确认

那么整个扫码登录过程为：
- 生成二维码：PC请求服务器，获得参数（二维码id）和URL，用来生成二维码，并轮询服务器，检测自己状态有没有变化
- 手机扫码：解析出url上的参数，连同token发往服务器，告诉服务器此id被我扫了
- 服务器更新此id状态：被当前已知身份的用户扫码，等待登录确认，待PC端下次轮询时告知PC
- PC轮询到自己的最新状态，可以关闭二维码，并文字提示用户可以确认登录
- 用户手机点击确认登录，发送服务端登录指令，服务端根据用户信息，生成新的token，准备颁发给PC
- PC下次轮询终于收到登录消息，并收到服务器种下的登录token，完成登录

## 安全方向发散一下
如果要做到绝对安全，上述步骤应该怎么加固从而避免攻击呢？
- HTTPS标配
- 注意时间间隔：二维码状态变更之间不能允许太长的时间间隔，减少攻击的可能性
- 轮询改为长连接
- 地区IP判断：扫码行为应该是同一地点发生，如果北京的PC被上海的IP手机扫码，那么肯定是被截图后扫码了
- 设备判断：一个历史登录中从未出现过的新PC设备，应提高风险率
- ...